<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Translate - Pham Huu Loc</title>
     <meta name="description" content="Pham Huu Loc - .NET Developer" />
    <meta name="keywords" content="Pham Huu Loc, PHL, .NET, ASP.NET" />
    <meta name="author" content="Pham Huu Loc" />
    <link rel="icon" type="image/png" href="https://raw.githubusercontent.com/phamhuuloc219/phamhuuloc219.github.io/refs/heads/main/images/phl.png" />
    
    <meta name="theme-color" content="#d32f2f" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="mobile-web-app-capable" content="yes">

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              "tet-red": "#d32f2f",
              "tet-yellow": "#fbc02d",
              "tet-bg": "#ffebee",
            },
            fontFamily: { sans: ["Segoe UI", "sans-serif"] },
          },
        },
      };
    </script>
    
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
  </head>
  <body class="bg-tet-bg min-h-screen flex items-center justify-center p-2 md:p-4">
    <main class="w-full max-w-6xl pt-4 md:pt-10">

      <div class="bg-white w-full rounded-xl shadow-xl overflow-hidden border border-red-100">      
        <div class="bg-tet-red p-4 text-tet-yellow text-center shadow-md">
          <h1 class="text-xl md:text-2xl font-bold uppercase tracking-wider">
            <i class="fas fa-language mr-2"></i>Translate
          </h1>
        </div>
  
        <div class="p-4 md:p-6 space-y-4 md:space-y-6">
          
          <div class="flex flex-row gap-2 md:gap-4 justify-between items-center bg-red-50 p-2 rounded-lg">
            <div class="w-full">
              <select id="sourceLang" class="w-full p-2 bg-white border border-red-200 rounded text-sm md:text-base focus:ring-2 focus:ring-tet-red outline-none font-medium text-gray-700">
                <option value="en" selected>English</option>
                <option value="vi">Vietnamese</option>
                <option value="ko">Korean</option>
                <option value="zh">Chinese</option>
              </select>
            </div>
  
            <div id="btnSwap" class="text-tet-red cursor-pointer p-2 rounded-full hover:bg-white transition-all flex-shrink-0" title="Hoán đổi">
              <svg class="fill-current w-6 h-6" viewBox="0 0 0.48 0.48" xmlns="http://www.w3.org/2000/svg">
                  <path d="m.302.21.03.03.103-.103L.33.03.3.06l.054.054H.06v.042h.295ZM.176.27.146.24.043.345.147.45l.03-.03L.123.366H.42V.324H.123Z"/>
              </svg>
            </div>
  
            <div class="w-full">
              <select id="targetLang" class="w-full p-2 bg-white border border-red-200 rounded text-sm md:text-base focus:ring-2 focus:ring-tet-red outline-none font-medium text-gray-700">
                <option value="en">English</option>
                <option value="vi" selected>Vietnamese</option>
                <option value="ko">Korean</option>
                <option value="zh">Chinese</option>
              </select>
            </div>
          </div>
  
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            
            <div class="relative group">
              <textarea
                id="inputText"
                rows="6"
                class="w-full p-4 pr-10 pb-8 border border-gray-300 rounded-lg focus:ring-2 focus:ring-tet-red focus:border-tet-red outline-none resize-none shadow-sm transition-shadow text-base"
                placeholder="Enter text..."
              ></textarea>
  
              <button id="btnClear" class="absolute top-2 right-2 text-gray-300 hover:text-tet-red p-2 transition opacity-0 group-hover:opacity-100 focus:opacity-100" title="Clear all">
                <i class="fas fa-times"></i>
              </button>
  
              <div id="charCount" class="absolute bottom-2 right-3 text-xs text-gray-400 font-medium">
                0/500
              </div>
            </div>
  
            <div class="relative bg-gray-50 rounded-lg border border-gray-200">
              <textarea
                id="outputText"
                rows="6"
                readonly
                class="w-full p-4 pr-10 bg-transparent border-none outline-none resize-none text-gray-800 font-medium text-base"
                placeholder="Translation result..."
              ></textarea>
  
              <button id="btnCopy" class="absolute top-2 right-2 text-gray-400 hover:text-tet-red p-2 transition" title="Copy results">
                <i class="fas fa-copy"></i>
              </button>
  
              <div id="loading" class="hidden absolute inset-0 bg-white/60 backdrop-blur-[1px] flex items-center justify-center rounded-lg z-10 transition-all">
                <div class="flex flex-col items-center">
                    <div class="animate-spin rounded-full h-8 w-8 border-4 border-gray-200 border-t-tet-red"></div>
                    <span class="text-xs text-tet-red font-bold mt-2 animate-pulse">Translating...</span>
                </div>
              </div>
            </div>
          </div>
          
          </div>
        
        <div id="errorModal" class="hidden fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-sm transition-opacity p-4">
          <div class="bg-white rounded-xl shadow-2xl w-full max-w-sm transform transition-all scale-100 overflow-hidden">
            <div class="bg-red-50 p-4 border-b border-red-100 flex items-center justify-between">
              <h3 class="font-bold text-red-600 flex items-center gap-2">
                  <i class="fas fa-exclamation-triangle"></i> Notification
              </h3>
              <button id="closeModalIcon" class="text-gray-400 hover:text-red-500 w-8 h-8 flex items-center justify-center rounded-full hover:bg-white transition">
                  <i class="fas fa-times"></i>
              </button>
            </div>
            <div class="p-6">
                <p id="errorMessage" class="text-gray-700 font-medium text-center"></p>
            </div>
            <div class="p-4 bg-gray-50 text-center">
                <button id="closeModalBtn" class="px-6 py-2 bg-tet-red hover:bg-red-700 text-white rounded-lg font-bold shadow-md transition w-full sm:w-auto">Close</button>
            </div>
          </div>
        </div>

      </div>
    </main>
    
    <script src="../layout.js"></script> 

    <script>
       const btnSwap = document.getElementById("btnSwap");
        const inputText = document.getElementById("inputText");
        const outputText = document.getElementById("outputText");
        const sourceLang = document.getElementById("sourceLang");
        const targetLang = document.getElementById("targetLang");
        const loading = document.getElementById("loading");
        const charCount = document.getElementById("charCount");
        const btnClear = document.getElementById("btnClear");
        const btnCopy = document.getElementById("btnCopy");

        const MAX_CHARS = 500;
        let debounceTimer; 

        function performTranslation() {
            const text = inputText.value.trim();
            const source = sourceLang.value;
            const target = targetLang.value;

            if (!text) {
                outputText.value = "";
                return;
            }

            if (source === target) {
                showError("Source and target languages cannot be the same!");
                return;
            }

            loading.classList.remove("hidden");

            const apiUrl = `https://api.mymemory.translated.net/get?q=${encodeURIComponent(text)}&langpair=${source}|${target}`;

            fetch(apiUrl)
                .then((response) => response.json())
                .then((data) => {
                    if (data.responseData) {
                        outputText.value = data.responseData.translatedText;
                    } else {
                        outputText.value = "Translation error.";
                    }
                })
                .catch((error) => {
                    console.error("Error:", error);

                    outputText.value = "Connection error."; 
                })
                .finally(() => {
                    loading.classList.add("hidden");
                });
        }

        inputText.addEventListener("input", () => {
            const currentLength = inputText.value.length;
            charCount.innerText = `${currentLength}/${MAX_CHARS}`;

            if (currentLength > MAX_CHARS) {
                charCount.classList.replace("text-gray-400", "text-tet-red");
                charCount.classList.add("font-bold");
                inputText.classList.add("border-tet-red", "focus:ring-red-500");
                inputText.classList.remove("border-gray-300", "focus:ring-tet-red");

                return; 
            } else {
                charCount.classList.replace("text-tet-red", "text-gray-400");
                charCount.classList.remove("font-bold");
                inputText.classList.remove("border-tet-red", "focus:ring-red-500");
                inputText.classList.add("border-gray-300", "focus:ring-tet-red");
            }

            clearTimeout(debounceTimer);

            debounceTimer = setTimeout(() => {
                performTranslation();
            }, 1500);
        });

        sourceLang.addEventListener("change", performTranslation);
        targetLang.addEventListener("change", performTranslation);

        btnClear.addEventListener("click", () => {
            inputText.value = "";
            outputText.value = "";
            charCount.innerText = `0/${MAX_CHARS}`;

            charCount.classList.replace("text-tet-red", "text-gray-400");
            inputText.classList.remove("border-tet-red");
            inputText.classList.add("border-gray-300");

            inputText.focus();
        });

        btnCopy.addEventListener('click', () => {
            const textToCopy = outputText.value;
            if (!textToCopy) return;

            navigator.clipboard.writeText(textToCopy).then(() => {
                const icon = btnCopy.querySelector('i');
                const originalClass = icon.className;

                icon.className = "fas fa-check text-green-600";
                setTimeout(() => { icon.className = "fas fa-copy"; }, 2000);
            });
        });

        btnSwap.addEventListener("click", () => {
            const svgIcon = btnSwap.querySelector("svg");
            if(svgIcon) {
                svgIcon.classList.add("rotate-180", "transition-transform", "duration-300");
                setTimeout(() => svgIcon.classList.remove("rotate-180"), 300);
            }

            const tempLang = sourceLang.value;
            sourceLang.value = targetLang.value;
            targetLang.value = tempLang;

            if (outputText.value && outputText.value !== "Translation error.") {
                inputText.value = outputText.value;
                outputText.value = ""; 

                charCount.innerText = `${inputText.value.length}/${MAX_CHARS}`;

                performTranslation();
            }
        });
    </script>
  </body>
</html>